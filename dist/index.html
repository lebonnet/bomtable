<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Bomtable example</title>
    <style>
        .example {
            border: 1px solid tomato;
        }

        .bomtable th {
            height: 52px !important;
        }
    </style>
<link href="main.css" rel="stylesheet"></head>
<body>
<div style="margin: 200px 100px;">
    <button onclick="createTable()">Пересоздать таблицу</button>
    <div style="padding: 0; max-height: 300px" class="example"></div>
</div>
<script type="text/javascript" src="bomtable.min.js"></script></body>
<script>
    let index = 1,
        tmpHeader = ['0', '1', '2', '3', '4', '5', '6'],
        tmpData = [
            ['номер созданой таблицы', index],
            [0, 7, 8, 'R3, R12, R37, R44, R47, R48, R49, R56, R57, R64, R65, R75, R77, R111, R118, R121, R126, R129, R134, R137, R142, R145, R401'],
            [1, 20, 30, 'Устройство коммутационное применяется в системах охранно-пожарной сигнализации, управления пожаротушением и предназначены для управления подключением и отключением исполнительных устройств'],
            [2, '&nbsp;&nbsp;USB-key protected "Guardant"', 5],
            [3],
            [4, 56, 55, 22, 15, 18],
            [5, 7, 1],
            [6],
            [13],
            [5, 12, 33, 84, 1, 22, 8, 1, 2, 3, 6, 4, 5, 7, 8, 9, 4, 12, 5, 4, 23, 5, 5, 22, 56, 4, 4, 6, 2, 4, 5, 555, 1, 111],
            [51, 4, 77, 8],
            [456],
            ['R57, R64, R65, R75, R77, R111, R221, R555']
        ],
        tmpData2 = [
            ['BAT54CWT1G (ONS)', 'SOT-323-3', 100],
            ['BAT54SWT1G (ONS)', 'SOT-323-3', 200],
            ['LQM21FN4R7N00L (MUR)', '', 524],
            ['CDRH3D16NP-100NC (SUMIDA)', '', 50],
            ['KX-7', 'CERCAP 0402', 1],
            ['Микросхема LM2575S-5.0', 'CERCAP 0603', 1],
            ['Разъем для электродов mini-XLR 92М-503', 'CERCAP 0603', 1],
            ['MAX6021AEUR+T (MAX)', 'CERCAP 0805', 1],
            ['SPBT2632C2A.AT2 (ST)', '', 1],
            ['AD7792BRUZ-REEL (AD)', 'TO-263-5', 30],
            ['STM32F205RGT6 (ST)', '', 30],
            ['L6924D013TR (ST)', 'TO-263-5', 30],
            ['USBDF01W5 (ST)', 'TO-263-5', 30],
            ['USBLC6-2P6 (ST)', '', 10],
            ['KX-327RT 32.768 kHz (GEYER)', 'SOT-23-3', 50],
            ['BAT54HT1G (ONS)', '', 50],
            ['47346-0001 (MOL)', 'TSSOP-16', 50],
            ['1-1734592-4 (TYCO)', 'LQFP-64', 50],
            ['293D106X9016A2TE3 (VISHAY)', '', 50],
            ['CC0603KRX5R8BB334 (YAG)', 'SOT-323-5', 50],
            ['BMA150 (BOSCH)', 'SOT-563', 50],
            ['MAX232N (TI)', '', 50],
            ['CERCAP 0.1/16V 0603 KX7R', 'SOD-323', 50],
            ['Микросхема 74HCT 123D', '', 52],
            ['Конденсатор корп2225 X7R 100 0,15 мкФ±10%', '', 100],
            ['DR-15-24 (MW)', '', 100]
        ];

    function boot() {
        createTable()
    }

    function createTable() {
        if (window.bi) {
            window.bi.destroy()
        }
        index++;
        let menu = {
                items: {
                    addRow: 'добавить строку',
                    addCol: 'добавить столбец',
                    hr: '',
                    removeRows: 'удалить строки',
                    removeCols: 'удалить столбцы',
                    hr1: '',
                    unionRows: 'объединить строки',
                    unionCols: 'объединить столбцы',
                },
                callback: (action, bomTable) => bomTable[action](),
            },
            header = [...tmpHeader],
            data = index % 2 === 0 ? tmpData : tmpData2;

        header.unshift(index + ' ' + index * 1000);
        window.bi = new BomTable({
            tableClass: 'ex-tbl',
            container: '.example',
            data,
            header,
            headerMenu: menu,
            contextMenu: menu,
            colsResize: true,
            rowsClass: 'row-class',
            colsClass: 'col-class',
            renders: (instance, el, colNum, rowNum) => {
                if (rowNum < 0) { // header
                    let f = colNum % 2 === 0 ? 'add' : 'remove';
                    el.classList[f]('tada');
                    return
                }
                el.style.background = (colNum + rowNum) % 2 === 0 ? '#eaeaea' : '#fff'
            },
            hooks: {
                beforeHeaderMenuRender: (instance, list) => {
                    delete list.hr;
                    delete list.removeRows;
                    delete list.removeCols;
                    delete list.hr1;
                    delete list.unionCols;
                }
            }
        });
    }

    boot()
</script>
</html>