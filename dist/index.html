<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Bomtable example</title>
    <style>
        .example {
            border: 1px solid tomato;
        }

        .bomtable th {
            height: 52px !important;
        }
    </style>
<link href="main.css" rel="stylesheet"></head>
<body>
<div style="margin: 200px 100px;">
    <button onclick="createTable()">Пересоздать таблицу</button>
    <div style="padding: 0; max-height: 300px" class="example"></div>
</div>
<script type="text/javascript" src="bomtable.min.js"></script></body>
<script>
    let index = 1,
        tmpHeader = ['0', '1', '2', '3', '4', '5', '6'],
        tmpData = [
            ['номер созданой таблицы', index],
            [0, 7, 8, 'R3, R12, R37, R44, R47, R48, R49, R56, R57, R64, R65, R75, R77, R111, R118, R121, R126, R129, R134, R137, R142, R145, R401'],
            [1, 20, 30, 'Устройство коммутационное применяется в системах охранно-пожарной сигнализации, управления пожаротушением и предназначены для управления подключением и отключением исполнительных устройств'],
            [2, '&nbsp;&nbsp;USB-key protected "Guardant"', 5],
            [3],
            [4, 56, 55, 22, 15, 18],
            [5, 7, 1],
            [6],
            [13],
            [5, 12, 33, 84, 1, 22, 8, 1, 2, 3, 6, 4, 5, 7, 8, 9, 4, 12, 5, 4, 23, 5, 5, 22, 56, 4, 4, 6, 2, 4, 5, 555, 1, 111],
            [51, 4, 77, 8],
            [456],
            ['R57, R64, R65, R75, R77, R111, R221, R555']
        ];

    function boot() {
        createTable()
    }

    function createTable() {
        if (window.bi) {
            window.bi.destroy()
        }
        index++;
        let menu = {
                items: {
                    addRow: 'добавить строку',
                    addCol: 'добавить столбец',
                    hr: '',
                    removeRows: 'удалить строки',
                    removeCols: 'удалить столбцы',
                    hr1: '',
                    unionRows: 'объединить строки',
                    unionCols: 'объединить столбцы',
                },
                callback: (action, bomTable) => bomTable[action](),
            },
            header = [...tmpHeader],
            data = [];

        tmpData.forEach((row, it) => {
            // if ((index + it) % 2 === 0) return;
            data.push(row)
        });
        header.unshift(index + ' ' + index * 1000);
        window.bi = new BomTable({
            tableClass: 'ex-tbl',
            container: '.example',
            data,
            header,
            headerMenu: menu,
            contextMenu: menu,
            colsResize: true,
            rowsClass: 'row-class',
            colsClass: 'col-class',
            renders: (instance, el, colNum, rowNum) => {
                if (rowNum < 0) { // header
                    let f = colNum % 2 === 0 ? 'add' : 'remove';
                    el.classList[f]('tada');
                    return
                }
                el.style.background = (colNum + rowNum) % 2 === 0 ? '#eaeaea' : '#fff'
            },
            hooks: {
                beforeHeaderMenuRender: (instance, list) => {
                    delete list.hr;
                    delete list.removeRows;
                    delete list.removeCols;
                    delete list.hr1;
                    delete list.unionCols;
                }
            }
        });
    }

    boot()
</script>
</html>